{"pageProps":{"source":"<div class=\"space-y-4 whitespace-normal *:first:mt-0 *:last:mb-0\"><p><a class=\"\" target=\"_blank\" href=\"https://github.com/crowdsecurity/crowdsec\">CrowdSec</a> est un <a class=\"\" href=\"/pare-feu\">Pare-feu</a> communautaire open-source pour se prot√©ger des attaques informatiques.</p>\n<p>Il analyse le comportement des visiteurs via les logs et r√©pond de mani√®re adapt√©e :</p><ul>\n<li>Bloquer l&#x27;adresse IP</li>\n<li>Ajouter un captcha</li>\n<li>Ajouter un code HTTP 403</li>\n<li>ect...</li>\n</ul><p>Les adresses IP agressives sont envoy√©es √† CrowdSec pour √™tre partag√©s entre tous les utilisateurs afin d&#x27;am√©liorer la s√©curit√© de chacun.</p><h2>Installation</h2><p>Pour l&#x27;installer sur <strong>Ubuntu</strong> ou <strong>Debian</strong> :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">curl -s https://install.crowdsec.net | sudo sh\nsudo apt install -y crowdsec\n</code></pre></div><p>Pour l&#x27;installer sur <strong>Arch Linux</strong> :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">yay -S --noconfirm crowdsec-bin\n</code></pre></div><p>Pour les autres syst√®mes, <a class=\"\" target=\"_blank\" href=\"https://doc.crowdsec.net/docs/getting_started/install_crowdsec/\">voir la documentation</a>.</p><h2>D√©sinstallation</h2><p>Pour le d√©sinstaller :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">sudo apt purge -y crowdsec crowdsec-firewall-bouncer-iptables\nsudo apt autoremove -y\nsudo rm -rf /usr/share/crowdsec/ /etc/crowdsec/\n</code></pre></div><h2>Initialisation</h2><p>Pour d√©marrer CrowdSec, il faut d√©marrer le service :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">sudo systemctl enable --now crowdsec\n</code></pre></div><p>Par d√©faut, crowdsec ne fait que lire les logs et afficher des <em>alertes</em>.</p><p>Pour r√©ellement bloquer les adresses IP suite √† une <em>d√©cision</em>, il faut installer le <em>bouncer</em> iptables :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">apt install -y crowdsec-firewall-bouncer-iptables # Ubuntu/Debian\n# Ou\nyay -S --noconfirm crowdsec-firewall-bouncer-iptables # Arch Linux\n\n# D√©marrer le service\nsudo systemctl enable --now crowdsec-firewall-bouncer\n</code></pre></div><h2>Bannir une adresse IP</h2><p>Pour bannir une adresse IP, voici la commande :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">cscli decisions add -t ban -i &lt;IP&gt;\n</code></pre></div><p>Ou une plage d&#x27;adresse IPs :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">cscli decisions add -t ban -r &lt;CIDR&gt;\n</code></pre></div><p>Il n&#x27;est pas possible de bannir une IP d√©finitivement, mais vous pouvez utiliser le param√®tre <code>-d 999999h</code> pour mettre une dur√©e de +100ans.</p><h2>Lister les alertes</h2><p>Vous pouvez lister les attaques d√©tect√©es par CrowdSec :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">cscli alerts list\n</code></pre></div><p>Et les inspecter plus en d√©tail :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">cscli alerts inspect -d &lt;id&gt;\n</code></pre></div><h2>Console de CrowdSec</h2><p>Et si vous souhaitez relier votre serveur √† la Console de CrowdSec (facultatif) :</p><ul>\n<li>Inscrivez-vous gratuitement sur https://app.crowdsec.net/signup</li>\n<li>Ex√©cuter la commande <code>cscli console enroll &lt;key&gt;</code> (la cl√© est affich√©e sur https://app.crowdsec.net/security-engines)</li>\n</ul><p>Cela vous permettra d&#x27;ajouter des blocklists facilement.</p><h2>Ajouter une blocklist manuellement</h2><p>Le plus simple pour ajouter une blocklist, c&#x27;est de passer par la [[#Console de CrowdSec|console]].</p><p>Mais il est possible d&#x27;importer manuellement une blocklist (ex: https://github.com/firehol/blocklist-ipsets/) :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">for ip in $(cat blocklist.txt); do cscli decisions add -t ban -i &quot;$ip&quot;; done\n</code></pre></div><h2>Ajouter une whitelist manuellement</h2><p>Et si vous souhaitez whitelister des IPs (ex: <a class=\"\" target=\"_blank\" href=\"https://api.github.com/meta\">les IPs de Github</a>), √©ditez le fichier <code>/etc/crowdsec/parsers/s02-enrich/whitelists.yaml</code> et relancez le service crowdsec.</p><p>Vous pouvez aussi cr√©er un fichier <code>/etc/crowdsec/parsers/s02-enrich/custom-whitelist.yaml</code>.</p><p>Exemple :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-yml\">name: custom/zammad-whitelist\ndescription: &quot;Whitelist traffic&quot;\nwhitelist:\n  reason: &quot;Legitimate traffic&quot;\n  expression:\n    - evt.Line.Raw contains &#x27;zammad&#x27;\n</code></pre></div><p>Pour v√©rifiez que votre whitelist est bien pris en compte, vous pouvez ex√©cuter un <code>cscli metrics | grep whitelist</code>.</p><p>Cr√©ez le fichier <code>/etc/crowdsec/postoverflows/s01-whitelist/custom-whitelist.yaml</code> si vous souhaitez l&#x27;appliquer uniquement pour un scenario sp√©cifique :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-yml\">name: custom/zammad-whitelist\ndescription: &quot;Whitelist traffic&quot;\nfilter: &quot;evt.Overflow.Alert.Scenario == &#x27;custom/http-crawl-non_statics&#x27;&quot;\nwhitelist:\n  reason: &quot;Legitimate traffic&quot;\n  expression:\n    - evt.Line.Raw contains &#x27;zammad&#x27;\n</code></pre></div><p>Vous pouvez v√©rifier que votre postoverflow existe bien avec <code>cscli postoverflows list</code>.</p><h2>Voir l&#x27;√©tat de CrowdSec</h2><p>Pour avoir un visuel de l&#x27;√©tat de crowdsec :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">cscli metrics\n</code></pre></div><h2>Supprimer les faux positifs</h2><p>Si vous rencontrez un faux positif, vous pouvez modifier les seuils de tol√©rance :</p><ol>\n<li>Identifier la raison du bannissement avec <code>cscli alerts inspect -d &lt;id&gt;</code></li>\n<li>Ajuster le <code>leakspeed</code> (vitesse d&#x27;oubli des erreurs), <code>capacity</code> (nombre d&#x27;erreurs avant ban) ou <code>filter</code> du scenario</li>\n<li>(facultatif) Ou supprimer le scenario en question via <code>cscli decisions remove --scenario &lt;scenario&gt;</code></li>\n<li>Puis red√©marrez avec <code>systemctl restart crowdsec</code> ou <code>kill -1 1</code> (si docker)</li>\n<li>D√©sactiver le ban manuellement avec <code>cscli decisions remove --id &lt;id&gt;</code></li>\n</ol><p>Par exemple, j&#x27;ai supprim√© le lien symbolique <code>/etc/crowdsec/scenarios/http-generic-bf.yaml</code> et j&#x27;ai cr√©er un nouveau fichier <code>/etc/crowdsec/scenarios/http-generic-bf-custom.yaml</code> avec les valeurs suivantes :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-diff\">--- /etc/crowdsec/hub/scenarios/crowdsecurity/http-generic-bf.yaml\n+++ /etc/crowdsec/scenarios/http-generic-bf-custom.yaml\n@@ -21,12 +21,12 @@\n # Generic 401 Authorization Errors\n type: leaky\n #debug: true\n-name: LePresidente/http-generic-401-bf\n+name: custom/http-generic-401-bf\n description: &quot;Detect generic 401 Authorization error brute force&quot;\n filter: &quot;evt.Meta.log_type == &#x27;http_access-log&#x27; &amp;&amp; evt.Parsed.verb == &#x27;POST&#x27; &amp;&amp; evt.Meta.http_status == &#x27;401&#x27;&quot;\n groupby: evt.Meta.source_ip\n-capacity: 5\n-leakspeed: &quot;10s&quot;\n+capacity: 10\n+leakspeed: &quot;5s&quot;\n blackhole: 1m\n labels:\n   confidence: 3\n@@ -41,12 +41,12 @@\n # Generic 403 Forbidden (Authorization) Errors\n type: leaky\n #debug: true\n-name: LePresidente/http-generic-403-bf\n+name: custom/http-generic-403-bf\n description: &quot;Detect generic 403 Forbidden (Authorization) error brute force&quot;\n filter: &quot;evt.Meta.log_type == &#x27;http_access-log&#x27; &amp;&amp; evt.Parsed.verb == &#x27;POST&#x27; &amp;&amp; evt.Meta.http_status == &#x27;403&#x27;&quot;\n groupby: evt.Meta.source_ip\n-capacity: 5\n-leakspeed: &quot;10s&quot;\n+capacity: 10\n+leakspeed: &quot;5s&quot;\n blackhole: 1m\n labels:\n   confidence: 3\n</code></pre></div><p>Pareil pour le scenario <code>http-crawl-non_statics</code> :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-diff\">--- /etc/crowdsec/hub/scenarios/crowdsecurity/http-crawl-non_statics.yaml\n+++ /etc/crowdsec/scenarios/http-crawl-non_statics-custom.yaml\n@@ -1,10 +1,10 @@\n type: leaky\n-name: crowdsecurity/http-crawl-non_statics\n+name: custom/http-crawl-non_statics\n description: &quot;Detect aggressive crawl on non static resources&quot;\n filter: &quot;evt.Meta.log_type in [&#x27;http_access-log&#x27;, &#x27;http_error-log&#x27;] &amp;&amp; evt.Parsed.static_ressource == &#x27;false&#x27; &amp;&amp; evt.Parsed.verb in [&#x27;GET&#x27;, &#x27;HEAD&#x27;]&quot;\n distinct: &quot;evt.Parsed.file_name&quot;\n-leakspeed: 0.5s\n-capacity: 40\n+leakspeed: 0.2s\n+capacity: 100\n #debug: true\n #this limits the memory cache (and event_sequences in output) to five events\n cache_size: 5\n</code></pre></div><p>Vos nouveaux scenarios devraient apparaitre dans le retour de la commande suivante :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">cscli metrics | grep custom\n</code></pre></div><h2>Cr√©ation d&#x27;un scenario personnalis√©</h2><p>Cr√©er un fichier (ex: <code>http-socketio-flood.yaml</code>) dans le dossier <code>/etc/crowdsec/scenarios/</code> avec le contenu suivant :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-yaml\">type: leaky\nname: custom/socketio-flood\ndescription: &quot;Detect Socket.IO polling flood&quot;\nfilter: &quot;evt.Meta.log_type in [&#x27;http_access-log&#x27;, &#x27;http_request&#x27;] &amp;&amp; evt.Parsed.request contains &#x27;/socket.io/&#x27;&quot;\ngroupby: &quot;evt.Meta.source_ip&quot;\ncapacity: 40\nleakspeed: &quot;1s&quot;\nblackhole: 1m\nlabels:\n service: http\n type: dos\n remediation: true\n</code></pre></div><p>Ne pas √©diter les fichiers dans le dossier <code>/etc/crowdsec/hub/scenarios/crowdsecurity/</code> car chaque modification peut √™tre √©craser par un simple <code>cscli hub update</code>.</p><h2>Tester la s√©curit√© de son serveur</h2><p>Pour v√©rifier si votre configuration de crowdsec fonctionne correctement vous pouvez simuler des attaques.</p><p>Par exemple, simuler des tentatives de connexion SSH √©chou√©es :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">for i in {1..10}; do ssh fakeuser@&lt;IP_ADDRESS&gt;; done\n</code></pre></div><p>Ou pour tester la s√©curit√© de votre serveur HTTP(S) :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">for i in {1..50}; do curl -s &quot;https://example.com/non-existent-page-$i&quot;; done\n# Ou\nnikto -host https://example.com\n</code></pre></div><blockquote class=\"callout note\">\n                    \n                        <div class=\"callout-title\">\n                            <div class=\"callout-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"2\" x2=\"22\" y2=\"6\"></line><path d=\"M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z\"></path></svg></div>\n                            <div class=\"callout-title-inner\">note</div>\n                        </div>\n                    \n                    <div class=\"callout-content\">\n                        <p>Effectuer ce test via une autre adresse IP (ex: via un VPN) pour √©viter d&#x27;√™tre bloqu√© üòÖ.</p>\n                    </div>\n                </blockquote><p>Puis v√©rifiez les d√©cisions de crowdec :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">sudo cscli decisions list\n</code></pre></div><p>Si une d√©cision apparait, vous ne devriez plus avoir acc√®s au serveur SSH ou HTTP(S) pendant plusieurs heures.</p><h2>Utilisation avec Traefik</h2><p>Pour utiliser CrowdSec avec Traefik et Docker Swarm, j&#x27;utilise ces 2 stacks docker :</p><ul>\n<li><a class=\"\" target=\"_blank\" href=\"https://github.com/ethibox/awesome-stacks/blob/master/stacks/traefik-crowdsec.yml\">Traefik</a></li>\n<li><a class=\"\" target=\"_blank\" href=\"https://github.com/ethibox/awesome-stacks/blob/master/stacks/crowdsec.yml\">Crowdsec</a></li>\n</ul><p>Installation de traefik :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">ACCESSLOG=true MIDDLEWARES=crowdsec-bouncer@file ACME_EMAIL=noreply@example.com docker stack deploy -c &lt;(curl -so - https://raw.githubusercontent.com/ethibox/awesome-stacks/master/stacks/traefik.yml) traefik\n</code></pre></div><p>Installation de crowdsec :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">docker stack deploy -c stacks/crowdsec.yml crowdsec\n</code></pre></div><p>Une fois install√©, j&#x27;ajoute la configuration suivante dans le fichier <code>/etc/crowdsec/acquis.d/traefik.yaml</code> √† l&#x27;int√©rieur du conteneur Crowdsec :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-txt\">filenames:\n  - /var/log/traefik/access.log\nlabels:\n  type: traefik\n</code></pre></div><p>J&#x27;ajoute un fichier <code>dynamic.yml</code> avec le contenu suivant :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">http:\n  middlewares:\n    crowdsec-bouncer:\n      forwardAuth:\n        address: http://crowdsec_bouncer:8080/api/v1/forwardAuth\n        trustForwardHeader: true\n</code></pre></div><p>Ensuite, je rentre la commande suivante √† l&#x27;int√©rieur du conteneur CrowdSec :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">docker exec -it $(docker ps -qf name=crowdsec_crowdsec) cscli bouncers add traefik-bouncer\n</code></pre></div><blockquote class=\"callout note\">\n                    \n                        <div class=\"callout-title\">\n                            <div class=\"callout-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"2\" x2=\"22\" y2=\"6\"></line><path d=\"M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z\"></path></svg></div>\n                            <div class=\"callout-title-inner\">note</div>\n                        </div>\n                    \n                    <div class=\"callout-content\">\n                        <p>Il est possible de devoir ex√©cuter cscli bouncers delete traefik-bouncer avant pour pouvoir r√©cup√©rer la cl√©.</p>\n                    </div>\n                </blockquote><p>Et je red√©marre la stack docker avec la variable d&#x27;environnement <code>CROWDSEC_BOUNCER_API_KEY</code> qui contient la cl√© d&#x27;api qui s&#x27;affiche en sortie de la commande pr√©c√©dente.</p><p>Chaque service reli√© √† Traefik sera prot√©g√© par CrowdSec.</p><p>Si vous ex√©cutez une commande comme <code>dirsearch -u https://example.com</code> sur un de vos sites internet, votre IP sera automatiquement banni pendant 4h.</p><p>J&#x27;ai quelques erreur au d√©marrage de traefik :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-txt\">ERR Error calling http://crowdsec_bouncer:8080/api/v1/forwardAuth error=&quot;Get \\&quot;http://crowdsec_bouncer:8080/api/v1/forwardAuth\\&quot;: context canceled&quot; middlewareName=crowdsec-bouncer@file middlewareType=ForwardAuth\n</code></pre></div><p>Mais cela n&#x27;emp√™che un bon fonctionnement. Cela semble √™tre des faux positifs.</p><p>Je vous conseille d&#x27;ajouter une t√¢che cron avec <a title=\"Note bient√¥t disponible\" class=\"!no-underline border-b-2 border-dotted border-cyan-700\" href=\"/soon?title=logrotate\">logrotate</a> pour limiter la taille des fichiers de log afin d&#x27;√©viter de saturer votre stockage :</p>\n<div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">@daily logrotate -f /etc/logrotate.d/traefik\n</code></pre></div><p>Avec la configuration suivante dans le fichier <code>/etc/logrotate.d/traefik</code> :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-txt\">/var/log/traefik/access.log {\n    rotate 14\n    missingok\n    notifempty\n    create 644 root root\n    postrotate\n        docker ps -qf name=traefik_traefik | xargs -r docker kill --signal=&quot;USR1&quot;\n        docker ps -qf name=crowdsec_crowdsec | xargs -r docker kill --signal=&quot;HUP&quot;\n    endscript\n}\n</code></pre></div><p>Et pour √©viter d&#x27;utiliser la collection <code>crowdsecurity/sshd</code>, vu que cela concerne uniquement traefik, je supprime la collection via la commande suivante :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">cscli collections remove --force crowdsecurity/sshd\n</code></pre></div><h2>Tester la configuration crowdsec</h2><p>Pour √©viter d&#x27;avoir le service crowdsec qui plante lors du changement, vous pouvez tester votre configuration avant :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">crowdsec -c /etc/crowdsec/config.yaml -t\n</code></pre></div><h2>Installer une nouvelle collection</h2><p>Si vous avez des bruteforce sur des application sp√©cifique (ex: wordpress), vous pouvez installer des collections :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">cscli collections install crowdsecurity/wordpress\n# Ou juste un scenario :\ncscli scenarios install crowdsecurity/http-bf-wordpress_bf_xmlrpc\n# Ou une liste blanche :\ncscli parsers install crowdsecurity/nextcloud-whitelist\n</code></pre></div><p>Possibilit√© de chercher des collections ou des scenario depuis les pages suivantes :</p><ul>\n<li>https://app.crowdsec.net/hub/collections</li>\n<li>https://app.crowdsec.net/hub/scenarios</li>\n</ul><h2>D√©bloquer une IP</h2><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">cscli alert list --ip &lt;ip&gt;\ncscli alert inspect &lt;id&gt;\ncat /var/log/traefik/access.log | grep &lt;ip&gt;\n</code></pre></div><hr/><p>R√©f√©rences :</p><ul>\n<li><a class=\"\" target=\"_blank\" href=\"https://youtu.be/5K7Aj5ya7uI\">Korben - D√©couverte et installation de Crowdsec</a></li>\n<li>https://docs.crowdsec.net/</li>\n<li>https://crowdsec.net/blog/enhance-docker-compose-security</li>\n<li>https://blog.levassb.ovh/post/crowdsec/</li>\n<li>https://github.com/crowdsecurity/hub/blob/master/collections/crowdsecurity/traefik.yaml</li>\n<li>https://github.com/maxlerebourg/crowdsec-bouncer-traefik-plugin</li>\n<li>https://github.com/fbonalair/traefik-crowdsec-bouncer</li>\n<li>https://app.crowdsec.net/hub/author/crowdsecurity/collections/traefik</li>\n<li>https://blog.stephane-robert.info/docs/securiser/reseaux/crowdsec/</li>\n<li>https://it-connect.fr/reverse-proxy-traefik-integration-de-crowdsec-pour-bloquer-les-attaques/</li>\n</ul></div>","isIndex":false,"file":"CrowdSec.md","fileName":"CrowdSec","title":"CrowdSec","comments":true,"permalink":"crowdsec","description":"CrowdSec est un pare-feu communautaire open-source pour se prot√©ger des attaques informatiques.","publish":true,"rss":true,"datePublished":"2024-04-22T10:00:00","dateUpdated":"2025-12-13T10:00:00"},"__N_SSG":true}