{"pageProps":{"source":"<div class=\"space-y-4 whitespace-normal *:first:mt-0 *:last:mb-0\"><p>Pour créer un thème dark avec <a class=\"\" target=\"_blank\" href=\"https://gatsbyjs.com/\">Gatsby</a> et <a class=\"\" target=\"_blank\" href=\"https://tailwindcss.com/\">TailwindCSS</a>, une fois que vous avez <a class=\"\" href=\"/initialiser-un-projet-gatsby\">initialisé Gatsby</a> et <a class=\"\" href=\"/integrer-tailwind-css-a-gatsby\">paramétré Tailwind CSS</a>, il vous faut simplement installer le package <code>react-helmet</code> et créer 3-4 fichiers.</p>\n<h2>1. Installer react-helmet</h2><p>Installer le package react-helmet pour pouvoir overrider la classe de votre balise <code>html</code>.</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">yarn add -D react-helmet gatsby-plugin-react-helmet\n</code></pre></div><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-js\">// gatsby-config.js\n\nmodule.exports = {\n    plugins: [\n        // ...\n        &#x27;gatsby-plugin-react-helmet&#x27;,\n    ],\n};\n</code></pre></div><h2>2. Activer le darkMode dans Tailwind CSS</h2><p>Dans le fichier <code>tailwind.config.js</code>, activez le darkMode en lui attribuant la valeur <code>class</code>, cela permettra de prendre en compte les classes html <code>dark:</code> :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">// tailwind.config.js\n\nmodule.exports = {\n    darkMode: &#x27;class&#x27;,\n};\n</code></pre></div><h2>3. Créer un Switch button</h2><p>Créez un composant <code>switch.js</code>, il contient le button qui peut alterner votre dark mode :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-js\">// src/components/switch.js\n\nimport React, { useState, useEffect } from &#x27;react&#x27;;\n\nconst isBrowser = () =&gt; typeof window !== &#x27;undefined&#x27;;\n\nconst getItem = (name) =&gt; isBrowser() &amp;&amp; localStorage.getItem(name);\n\nconst setItem = (name, item) =&gt; isBrowser() &amp;&amp; localStorage.setItem(name, item);\n\nexport default ({ onChange }) =&gt; {\n    const [darkMode, setDarkMode] = useState(getItem(&#x27;darkMode&#x27;) === &#x27;true&#x27; || (isBrowser() &amp;&amp; window.matchMedia(&#x27;(prefers-color-scheme: dark)&#x27;).matches));\n\n    useEffect(() =&gt; {\n        setItem(&#x27;darkMode&#x27;, darkMode);\n        onChange(darkMode);\n    }, [darkMode]);\n\n    return (\n        &lt;button type=&quot;button&quot; className=&quot;border px-2&quot; onClick={() =&gt; setDarkMode(!darkMode)}&gt;Switch&lt;/button&gt;\n    );\n};\n</code></pre></div><p>Intégrez votre composant <code>Switch</code> dans votre page Gatsby <code>index.js</code> :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-javascript\">// src/pages/index.js\n\nimport React, { useState } from &#x27;react&#x27;;\nimport Helmet from &#x27;react-helmet&#x27;;\n\nimport Switch from &#x27;../components/switch&#x27;;\n\nconst IndexPage = () =&gt; {\n    const [darkMode, setDarkMode] = useState(typeof window !== &#x27;undefined&#x27; &amp;&amp; localStorage.getItem(&#x27;darkMode&#x27;) === &#x27;true&#x27;);\n\n    return (\n        &lt;&gt;\n            &lt;Helmet\n                htmlAttributes={{ class: darkMode ? &#x27;dark&#x27; : &#x27;light&#x27; }}\n                bodyAttributes={{ class: &#x27;dark:bg-gray-900 dark:text-gray-300&#x27; }}\n            /&gt;\n            &lt;Switch onChange={(isDark) =&gt; setDarkMode(isDark)} /&gt;\n        &lt;/&gt;\n    );\n};\n\nexport default IndexPage;\n</code></pre></div><h2>4. Créer un fichier gatsby-ssr.js (facultatif)</h2><p>Cette étape est facultatif, mais elle permet d&#x27;améliorer la vitesse de rendu du thème dark.</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-js\">// gatsby-ssr.js\n\nimport React from &#x27;react&#x27;;\n\nexport { wrapRootElement } from &#x27;./gatsby-browser&#x27;;\n\nexport const onRenderBody = ({ setPreBodyComponents }) =&gt; {\n    const setColorsByTheme = () =&gt; {\n        const darkMode = localStorage.getItem(&#x27;darkMode&#x27;) === &#x27;true&#x27; || window.matchMedia(&#x27;(prefers-color-scheme: dark)&#x27;).matches;\n        document.documentElement.className = darkMode ? &#x27;dark&#x27; : &#x27;light&#x27;;\n    };\n\n    const calledFunction = `(${setColorsByTheme})()`;\n    setPreBodyComponents(&lt;script key=&quot;darkMode&quot; dangerouslySetInnerHTML={{ __html: calledFunction }} /&gt;);\n};\n</code></pre></div><hr/><p>Références :</p><ul>\n<li>https://joshwcomeau.com/react/dark-mode/</li>\n<li>https://github.com/insin/gatsby-plugin-dark-mode/</li>\n</ul></div>","isIndex":false,"file":"Créer un mode dark avec Gatsby et Tailwind CSS.md","fileName":"Créer un mode dark avec Gatsby et Tailwind CSS","title":"Créer un mode dark avec Gatsby et Tailwind CSS","comments":true,"permalink":"creer-un-mode-dark-avec-gatsby-et-tailwind-css","datePublished":"2021-11-15T09:33","dateUpdated":"2021-11-15T09:33","publish":true,"rss":true,"note":"77"},"__N_SSG":true}