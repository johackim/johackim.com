{"pageProps":{"source":"<div class=\"space-y-4 whitespace-normal *:first:mt-0 *:last:mb-0\"><p>Après avoir <a class=\"\" href=\"/initialiser-un-projet-gatsby\">Initialiser un projet Gatsby</a> et <a class=\"\" href=\"/importer-ses-notes-markdown-dans-gatsby\">importer vos fichiers markdown</a>, vous pouvez créer automatiquement la table des matière d&#x27;un fichier markdown dans Gatsby.</p>\n<div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-javascript\">// gatsby-node.js\nexports.createPages = async ({ actions, graphql, reporter }) =&gt; {\n    const { createPage } = actions;\n\n    const result = await graphql(`\n        {\n            allMarkdownRemark {\n                edges {\n                    node {\n                        id\n                        html\n                        headings {\n                            value\n                            depth\n                        }\n                        parent {\n                            ... on File {\n                                name\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    `);\n\n    if (result.errors) {\n        reporter.panicOnBuild(&#x27;Error while running GraphQL query.&#x27;);\n        return;\n    }\n\n    const markdowns = result.data.allMarkdownRemark.edges;\n\n    const noteTemplate = require.resolve(&#x27;./src/templates/noteTemplate.js&#x27;);\n\n    markdowns.forEach(({ node }) =&gt; {\n        const { id, html, headings } = node;\n\n        createPage({\n            path: `/${node.parent.name}`,\n            component: noteTemplate,\n            context: { id, html, headings },\n        });\n    });\n};\n</code></pre></div><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-javascript\">// src/components/toc.js\nimport React from &#x27;react&#x27;;\nimport { Link } from &#x27;gatsby&#x27;;\nimport slugify from &#x27;slugify&#x27;;\n\nexport default ({ headings = [], depthMin = 1, className = &#x27;&#x27; }) =&gt; {\n    if (!headings.length) return false;\n\n    return (\n        &lt;ul className={className}&gt;\n            {headings.filter(({ depth }) =&gt; depth &gt;= depthMin).map(({ value }) =&gt; {\n                const id = slugify(value, { lower: true, strict: true });\n\n                return (\n                    &lt;li key={value}&gt;\n                        &lt;Link to={`#${id}`} title={value}&gt;\n                            {value}\n                        &lt;/Link&gt;\n                    &lt;/li&gt;\n                );\n            })}\n        &lt;/ul&gt;\n    );\n};\n</code></pre></div><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-js\">// src/templates/noteTemplate.js\nimport React from &#x27;react&#x27;;\nimport Toc from &#x27;../components/toc&#x27;;\n\nexport default function Template({ pageContext }) {\n    const { html, headings } = pageContext;\n\n    return (\n        &lt;&gt;\n            &lt;Toc headings={headings} depthMin={2} /&gt;\n            &lt;div dangerouslySetInnerHTML={{ __html: html }} /&gt;\n        &lt;/&gt;\n    );\n}\n</code></pre></div><p>Pour créer automatiquement les id sur chaque header, il existe le plugin <a class=\"\" target=\"_blank\" href=\"https://gatsbyjs.com/plugins/gatsby-remark-autolink-headers/\">gatsby-remark-autolink-headers</a> :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-npm\">yarn add -D gatsby-remark-autolink-headers\n</code></pre></div><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-javascript\">// gatsby-config.js\nmodule.exports = {\n    plugins: [\n        {\n            resolve: &#x27;gatsby-source-filesystem&#x27;,\n            options: {\n                path: &#x27;./content&#x27;,\n            },\n        },\n        {\n            resolve: &#x27;gatsby-transformer-remark&#x27;,\n            options: {\n                plugins: [\n                    {\n                        resolve: &#x27;gatsby-remark-autolink-headers&#x27;,\n                        options: {\n                            icon: false,\n                        },\n                    },\n                ],\n            },\n        },\n    ],\n};\n</code></pre></div></div>","isIndex":false,"file":"Créer une table des matières sur Gatsby.md","fileName":"Créer une table des matières sur Gatsby","title":"Créer une table des matières des fichiers markdown avec Gatsby","comments":true,"permalink":"creer-une-table-des-matieres-des-fichiers-markdown-avec-gatsby","datePublished":"2021-05-31T16:00","dateUpdated":"2021-05-31T16:00","publish":true,"rss":true,"note":"62"},"__N_SSG":true}