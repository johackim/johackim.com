{"pageProps":{"source":"<div class=\"space-y-4 whitespace-normal *:first:mt-0 *:last:mb-0\"><p>Pour générer des certificats SSL, rien de mieux que Let&#x27;s Encrypt pour effectuer automatiquement cette tâche.</p><p>En rendant publiquement accessible les ports 80 et 443, <a class=\"\" href=\"/traefik\">Traefik</a> va automatiquement communiquer avec Let&#x27;s Encrypt pour générer automatiquement des certificats SSL à chaque fois qu&#x27;un nouveau nom de domaine est relié à une application.</p>\n<h2>Vérifiez que vos ports 80 et 443 sont accessibles publiquement</h2><p>Avant de lancer Traefik, n&#x27;oubliez pas de vérifiez si vos ports 80 et 443 sont bien accessible depuis l&#x27;extérieur de votre réseau pour que Let&#x27;s Encrypt puisse communiquer avec votre serveur Traefik.</p><p>Utilisez la commande <code>curl https://ipv4.am.i.mullvad.net/port/80</code> (depuis votre serveur) ou https://canyouseeme.org/ pour vérifier.</p><h2>Créez une zone DNS de type A</h2><p>Créez une zone DNS de type A vers l&#x27;adresse IP publique de votre serveur, exemple : <code>ghost.example.com</code> -&gt; <code>IN A 9.9.9.9</code>.</p><p>Pour ça, passez par le registraire de votre nom de domaine (ex: <a class=\"\" target=\"_blank\" href=\"https://ovh.com/fr/\">OVH</a>, <a class=\"\" target=\"_blank\" href=\"https://gandi.net/fr\">Gandi</a>, <a class=\"\" target=\"_blank\" href=\"https://godaddy.com/fr-fr\">GoDaddy</a> ou <a class=\"\" target=\"_blank\" href=\"https://www.ionos.fr/domaine/noms-de-domaine\">1&amp;1</a>).</p><h2>Démarrez Traefik avec Docker Swarm et Let&#x27;s Encrypt</h2><p>Démarrez Traefik :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-yaml\">version: &#x27;3.8&#x27;\n\nservices:\n  traefik:\n    image: traefik:${VERSION:-2.4.8}\n    command:\n      - --providers.docker\n      - --providers.docker.network=traefik-net\n      - --providers.docker.exposedByDefault=false\n      - --providers.docker.swarmMode=true\n      - --providers.docker.endpoint=unix:///var/run/docker.sock\n      - --entrypoints.http.address=:80\n      - --entrypoints.https.address=:443\n      - --entrypoints.http.http.redirections.entryPoint.to=https\n      - --entrypoints.http.http.redirections.entryPoint.scheme=https\n      - --entrypoints.http.http.redirections.entrypoint.permanent=true\n      - --certificatesresolvers.letsencrypt.acme.tlschallenge=true\n      - --certificatesresolvers.letsencrypt.acme.email=${ACME_EMAIL:-noreply@ethibox.fr}\n      - --certificatesresolvers.letsencrypt.acme.storage=/letsencrypt/acme.json\n    volumes:\n      - ${VOLUME_PATH}letsencrypt:/letsencrypt\n      - /var/run/docker.sock:/var/run/docker.sock:ro\n    ports:\n      - {target: 80, published: 80, mode: host, protocol: tcp}\n      - {target: 443, published: 443, mode: host, protocol: tcp}\n\nvolumes:\n  letsencrypt:\n\nnetworks:\n  default:\n    external: true\n    name: traefik-net\n</code></pre></div><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">docker stack deploy -c traefik.yml traefik\n</code></pre></div><p>Créer une application avec un nom de domaine que vous disposez (ex: ghost.example.com) :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">docker service create --network traefik-net \\\n-l traefik.enable=true \\\n-l traefik.http.routers.my-container.rule=&#x27;Host(`ghost.example.com`)&#x27; \\\n-l traefik.http.services.my-service.loadbalancer.server.port=2368 ghost\n</code></pre></div><p>Un certificat est automatiquement généré et vous pouvez à présent accéder à votre application avec le protocole HTTPS : <code>https://ghost.example.com</code>.</p></div>","isIndex":false,"file":"Traefik et Let's Encrypt.md","fileName":"Traefik et Let's Encrypt","title":"Traefik et Let's Encrypt","comments":true,"permalink":"traefik-et-let's-encrypt","datePublished":"2021-05-17T17:32","dateUpdated":"2021-05-17T17:32","publish":true,"rss":true},"__N_SSG":true}