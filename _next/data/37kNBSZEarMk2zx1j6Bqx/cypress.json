{"pageProps":{"source":"<div class=\"space-y-4 whitespace-normal *:first:mt-0 *:last:mb-0\"><p><a class=\"\" target=\"_blank\" href=\"https://cypress.io/\">Cypress</a> est un framework de test E2E Node.js.</p><h2>Installation</h2><p>Pour l&#x27;installer :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">yarn add -D cypress\n</code></pre></div><h2>Utilisation</h2><p>Pour ouvrir l&#x27;interface utilisateur :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">npx cypress open\n</code></pre></div><p>Démarrer les tests</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">npx cypress run\n</code></pre></div><p>Démarrer un seul test :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">npx cypress run -s &lt;path&gt;\n</code></pre></div><h2>Configuration</h2><p>Créez un fichier <code>cypress.json</code> :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-json\">cat &gt; cypress.json &lt;&lt; EOF\n{\n    &quot;fixturesFolder&quot;: false,\n    &quot;pluginsFile&quot;: &quot;__tests__/integration/plugins.js&quot;,\n    &quot;integrationFolder&quot;: &quot;__tests__/integration/&quot;,\n    &quot;testFiles&quot;: &quot;*.spec.js&quot;,\n    &quot;supportFile&quot;: false,\n    &quot;screenshotOnRunFailure&quot;: false,\n    &quot;trashAssetsBeforeRuns&quot;: false,\n    &quot;video&quot;: false,\n    &quot;defaultCommandTimeout&quot;: 10000,\n    &quot;requestTimeout&quot;: 10000,\n    &quot;baseUrl&quot;: &quot;http://localhost:3000&quot;,\n    &quot;chromeWebSecurity&quot;: false,\n    &quot;retries&quot;: {\n        &quot;runMode&quot;: 2,\n        &quot;openMode&quot;: 0\n    }\n}\nEOF\n</code></pre></div><p>Ajoutez si besoin les lignes suivantes dans votre fichier <code>.eslintrc.json</code> pour configurer Eslint :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-json\">{\n    &quot;plugins&quot;: [\n        &quot;cypress&quot;\n    ],\n    &quot;env&quot;: {\n        &quot;cypress/globals&quot;: true\n    }\n}\n</code></pre></div><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">yarn add -D eslint-plugin-cypress\n</code></pre></div><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">npm pkg set scripts.test:e2e=&quot;cypress run&quot;\n</code></pre></div><h2>Ajouter des sélecteurs data-test</h2><p>Pour faciliter la sélection de vos éléments HTML, ajoutez des sélecteurs <code>data-test</code> ou <code>data-testid</code> dans votre code.</p><p>Exemples :</p><ul>\n<li><code>&lt;input type=&quot;text&quot; data-test=login-username /&gt;</code></li>\n<li><code>&lt;input type=&quot;text&quot; data-testid=login-username /&gt;</code></li>\n</ul><h2>Supporter les variables d&#x27;environnement dotenv</h2><p>Si vous souhaitez utiliser des variables d&#x27;environnements en provenance d&#x27;un fichier <code>.env</code> dans vos tests, installez la librairie suivante :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-bash\">yarn add -D cypress-dotenv\n</code></pre></div><p>Ajouter des custom commands dans le fichier <a class=\"\" target=\"_blank\" href=\"https://docs.cypress.io/api/cypress-api/custom-commands\">commands.js</a></p><p>Check from front : <code>if (window.Cypress === undefined)</code></p><p>Stripe :</p><div class=\"relative group\"><button type=\"button\" class=\"invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none\">Copier</button><pre><code class=\"language-js\">it(&#x27;Should install the app&#x27;, () =&gt; {\n    let stripeCheckoutUrl = &#x27;&#x27;;\n    cy.on(&#x27;uncaught:exception&#x27;, () =&gt; false);\n    cy.intercept(&#x27;POST&#x27;, &#x27;/api/stripe&#x27;, (req) =&gt; {\n        req.continue((res) =&gt; {\n            stripeCheckoutUrl = res.body.url;\n        });\n    }).as(&#x27;getStripe&#x27;);\n\n    cy.visit(&#x27;/&#x27;);\n    cy.get(&#x27;[data-test=&quot;install-app&quot;]:first&#x27;).click();\n    cy.wait(&#x27;@getStripe&#x27;).then(() =&gt; {\n        cy.visit(stripeCheckoutUrl);\n        cy.get(&#x27;#cardNumber&#x27;).type(&#x27;4242424242424242&#x27;);\n        cy.get(&#x27;#cardExpiry&#x27;).type(&#x27;0424&#x27;);\n        cy.get(&#x27;#cardCvc&#x27;).type(&#x27;424&#x27;);\n        cy.get(&#x27;#billingName&#x27;).type(&#x27;John Doe&#x27;);\n        cy.get(&#x27;.SubmitButton&#x27;).click();\n\n        cy.url().should(&#x27;contain&#x27;, &#x27;/apps&#x27;);\n    });\n});\n</code></pre></div><hr/><p>Références :</p><ul>\n<li>https://github.com/cypress-io/cypress-realworld-app</li>\n<li>https://marmelab.com/blog/2023/11/20/screenshot-ci.html</li>\n<li>https://pro.academind.com/p/cypress-end-to-end-testing-getting-started</li>\n<li>\n<a title=\"Note bientôt disponible\" class=\"!no-underline border-b-2 border-dotted border-cyan-700\" href=\"/soon?title=Testing\">Testing</a>\n\n</li>\n</ul></div>","isIndex":false,"file":"Cypress.md","fileName":"Cypress","title":"Cypress","comments":true,"permalink":"cypress","datePublished":"2022-06-27T12:56","dateUpdated":"2022-06-29T01:29","publish":true,"rss":true,"note":"78"},"__N_SSG":true}