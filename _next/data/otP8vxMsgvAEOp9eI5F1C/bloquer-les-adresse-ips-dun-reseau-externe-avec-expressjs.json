{"pageProps":{"source":{"compiledSource":"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    code: \"code\",\n    p: \"p\",\n    pre: \"pre\",\n    ..._provideComponents(),\n    ...props.components\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"Je dispose d'un serveur nodejs avec express et j'ai besoin d'autoriser l'accès à une route uniquement aux adresses IP de mon réseau interne.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Pour ça, j'utilise une librairie : \", _jsx(_components.code, {\n        children: \"express-ipfilter\"\n      }), \" :\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"// index.js\\n\\nimport express from 'express';\\nimport { IpFilter, IpDeniedError } from 'express-ipfilter';\\n\\nconst app = express();\\n\\nconst clientIp = (req) => {\\n    return req.headers['x-forwarded-for'] ? (req.headers['x-forwarded-for']).split(',')[0] : req.socket.remoteAddress;\\n};\\n\\nconst ips = ['172.17.0.0/16', '10.10.0.0/16', '127.0.0.1', '::1'];\\n\\napp.use(IpFilter(ips, { mode: 'allow', detectIp: clientIp }));\\n\\napp.use((err, req, res, next) => {\\n    if (err instanceof IpDeniedError) {\\n        res.status(401);\\n        return res.end('You shall not pass');\\n    }\\n\\n    return next();\\n});\\n\\napp.get('/', async (req, res) => {\\n    res.end('Secure route');\\n});\\n\\nexport default app;\\n\"\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = {\n    ..._provideComponents(),\n    ...props.components\n  };\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{"title":"Bloquer les adresse IPs d'un réseau externe avec Express.js","permalink":"bloquer-les-adresse-ips-dun-reseau-externe-avec-expressjs","datePublished":"2021-08-01T21:31","dateUpdated":"2021-08-01T21:31","publish":true,"rss":true,"note":46},"scope":{}},"isIndex":false,"file":"Express.js.md","fileName":"Express.js","comments":true,"title":"Bloquer les adresse IPs d'un réseau externe avec Express.js","permalink":"bloquer-les-adresse-ips-dun-reseau-externe-avec-expressjs","datePublished":"2021-08-01T21:31","dateUpdated":"2021-08-01T21:31","publish":true,"rss":true,"note":46},"__N_SSG":true}