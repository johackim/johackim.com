{"pageProps":{"source":{"compiledSource":"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    a: \"a\",\n    code: \"code\",\n    h2: \"h2\",\n    p: \"p\",\n    pre: \"pre\",\n    ..._provideComponents(),\n    ...props.components\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"Si vous souhaitez parser un site internet, il existe \", _jsx(_components.a, {\n        href: \"https://github.com/puppeteer/puppeteer\",\n        children: \"puppeteer\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Installation\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Pour installer puppeteer :\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-bash\",\n        children: \"yarn add -D puppeteer\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Prendre un screenshot\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Voici un exemple de script Node.js pour prendre un screenshot d'un site internet :\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"#!/bin/node\\n\\nconst puppeteer = require('puppeteer');\\n\\n(async () => {\\n  const browser = await puppeteer.launch();\\n  const page = await browser.newPage();\\n  await page.goto('https://johackim.com');\\n  await page.screenshot({ path: 'example.png' });\\n\\n  await browser.close();\\n})();\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Parser l'URL d'une vidéo\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Si la page que vous souhaitez parser dispose d'un lien video, vous pouvez reprendre son URL :\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"const url = await page.$eval('video', (a) => a.getAttribute('src'));\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Et si vous intégrer \", _jsx(_components.code, {\n        children: \"youtube-dl\"\n      }), \", vous pouvez enregistrer la vidéo en question :\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"await execSync(`youtube-dl -o \\\"${filePath}\\\" -f 'best[ext=mp4]' ${url}`, { stdio: 'inherit' });\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Vous connecter sur un site automatiquement\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Vous pouvez vous connecter automatiquement sur un site en remplissant automatiquement les champs \", _jsx(_components.code, {\n        children: \"email\"\n      }), \" et \", _jsx(_components.code, {\n        children: \"password\"\n      }), \", puis sauvegarder le cookie dans un fichier \", _jsx(_components.code, {\n        children: \"cookie.json\"\n      }), \" :\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"await page.focus('input#email');\\nawait page.keyboard.type(email);\\n\\nawait page.focus('input#password');\\nawait page.keyboard.type(password);\\n\\nawait page.click('.container form button[type=submit]');\\n\\nawait page.waitForSelector('.logged-in');\\n\\nconst cookies = await page.cookies();\\nawait page.setCookie(...cookies);\\n\\nfs.writeFileSync('cookie.json', JSON.stringify(cookies, null, 2));\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Facultatif : vous pouvez exporter le cookie directement depuis votre navigateur via \", _jsx(_components.a, {\n        href: \"https://chrome.google.com/webstore/detail/json-for-puppet/nmckokihipjgplolmcmjakknndddifde\",\n        children: \"cette extension\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Pour réutiliser vos cookies dans une autre session Puppeteer :\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"const cookieFile = await fs.readFile('cookies.json');\\nconst cookies = JSON.parse(cookieFile);\\nawait page.setCookie(...cookies);\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Modifier les paramètre du navigateur headless\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Puppetteer vous permet de modifier les paramètres du navigateur headless. Si vous souhaitez modifier le navigateur ou le header HTTP User-Agent, écrivez les lignes suivantes :\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"const browser = await puppeteer.launch({ executablePath: '/usr/bin/google-chrome-stable' });\\nconst page = await browser.newPage();\\nawait page.setUserAgent('Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4512.0 Safari/537.36');\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Récupérer le contenu complet d'une page HTML\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"const html = await page.content();\\n// Ou\\nconst html = await page.evaluate(() => document.body.innerHTML);\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Debugger\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Pour débugger, désactivez le mode \", _jsx(_components.code, {\n        children: \"headless\"\n      }), \" :\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-bash\",\n        children: \"await puppeteer.launch({ headless: false });\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Cela vous permettra de visualiser le rendu directement depuis un vrai navigateur.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = {\n    ..._provideComponents(),\n    ...props.components\n  };\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{"title":"Puppeteer","permalink":"puppeteer","datePublished":"2021-06-07T20:36","dateUpdated":"2021-06-07T20:36","publish":true,"rss":true},"scope":{}},"isIndex":false,"file":"Puppeteer.md","fileName":"Puppeteer","comments":true,"title":"Puppeteer","permalink":"puppeteer","datePublished":"2021-06-07T20:36","dateUpdated":"2021-06-07T20:36","publish":true,"rss":true},"__N_SSG":true}