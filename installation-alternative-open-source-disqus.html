<!DOCTYPE html><html lang="fr"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@_johackim" data-next-head=""/><meta name="twitter:creator" content="@_johackim" data-next-head=""/><meta property="og:url" content="https://johackim.com" data-next-head=""/><meta property="og:locale" content="fr_FR" data-next-head=""/><meta property="og:site_name" content="johackim" data-next-head=""/><title data-next-head="">Installation d&#x27;une alternative open-source à Disqus | Johackim - Hacker indépendant</title><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="N&#x27;ayant pas envie d&#x27;utiliser une solution propriétaire pour gérer les commentaires de mon blog je me suis configuré une petite installation de Isso via dokku." data-next-head=""/><meta property="og:title" content="Installation d&#x27;une alternative open-source à Disqus" data-next-head=""/><meta property="og:description" content="N&#x27;ayant pas envie d&#x27;utiliser une solution propriétaire pour gérer les commentaires de mon blog je me suis configuré une petite installation de Isso via dokku." data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="article:published_time" content="2017-11-03T18:00:00.000Z" data-next-head=""/><meta property="article:modified_time" content="2017-11-03T18:00:00.000Z" data-next-head=""/><meta property="og:image" content="https://johackim.com/covers/installation-alternative-open-source-disqus.jpg" data-next-head=""/><link rel="preload" href="/_next/static/media/ce62453a442c7f35-s.p.a9507876.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/chunks/8ed76ae3e03c2690.css" as="style"/><script type="application/ld+json" data-next-head="">{"@context":"https://schema.org","@type":"article","datePublished":"2017-11-03T18:00:00.000Z","description":"N&apos;ayant pas envie d&apos;utiliser une solution propriétaire pour gérer les commentaires de mon blog je me suis configuré une petite installation de Isso via dokku.","mainEntityOfPage":{"@type":"WebPage","@id":"https://johackim.com/installation-alternative-open-source-disqus"},"headline":"Installation d&apos;une alternative open-source à Disqus","image":["https://johackim.com/covers/installation-alternative-open-source-disqus.jpg"],"dateModified":"2017-11-03T18:00:00.000Z","author":{"@type":"Person","name":"Johackim"}}</script><link rel="stylesheet" href="/_next/static/chunks/8ed76ae3e03c2690.css" data-n-g=""/><noscript data-n-css=""></noscript><script src="/_next/static/chunks/6fcffc6692497eb2.js" defer=""></script><script src="/_next/static/chunks/e0b21ddcf7569f89.js" defer=""></script><script src="/_next/static/chunks/fd2ee175bc0e71ae.js" defer=""></script><script src="/_next/static/chunks/a30cd4a014a30a7f.js" defer=""></script><script src="/_next/static/chunks/turbopack-131034d42197997f.js" defer=""></script><script src="/_next/static/chunks/62da9d2d3019bdf2.js" defer=""></script><script src="/_next/static/chunks/7ddd13e7cb3b66c4.js" defer=""></script><script src="/_next/static/chunks/turbopack-7b68a056b6da782c.js" defer=""></script><script src="/_next/static/W4ieti9wfstDP6ydypVim/_ssgManifest.js" defer=""></script><script src="/_next/static/W4ieti9wfstDP6ydypVim/_buildManifest.js" defer=""></script><style id="__jsx-1922640940">html{font-family:'Roboto', 'Roboto Fallback'}</style></head><body><div id="__next"><header class="flex shadow-md inset-x-0 h-16 items-center z-30 text-gray-700 bg-white fixed top-0"><div class="container m-auto flex items-center justify-between flex-wrap px-2 sm:px-4 lg:max-w-screen-lg"><a href="/"><div class="flex items-center"><img alt="logo" loading="lazy" width="48" height="48" decoding="async" data-nimg="1" class="rounded-full w-12" style="color:transparent" src="/profile.jpg"/><div class="ml-2"><div class="font-bold leading-none">Johackim</div><div class="text-sm leading-none">Hacker indépendant</div></div></div></a><nav class="grid grid-flow-col gap-4 items-center"><a class="hover:underline hidden md:block" href="/">Accueil</a><a class="hover:underline md:block" href="/articles">Articles</a><a href="/newsletter"><button type="button" class="bg-cyan-700 text-white hover:text-white hover:bg-cyan-800 px-2.5 py-1.5 rounded-md cursor-pointer">S&#x27;abonner</button></a></nav></div></header><main class="lg:max-w-screen-lg m-auto px-4"><div class="bg-cyan-600 h-1 z-30 fixed inset-0" style="width:0%"></div><div class="md:border md:border-gray-200 mt-20"><h1 class="h-64 flex flex-col justify-center relative border-b border-gray-200"><span class="absolute inset-0 bg-gray-100 opacity-80 z-10"></span><span class="transform text-center font-bold px-4 text-4xl text-gray-600 break-words z-20">Installation d&#x27;une alternative open-source à Disqus</span></h1><div class="text-xs my-4 md:px-4 text-gray-700"><span>Mis à jour le </span><span>vendredi 3 novembre 2017</span><span> par <a class="underline text-cyan-700" href="/a-propos">johackim</a></span></div><article class="prose break-words prose-a:font-normal prose-a:text-cyan-700 prose-a:break-words marker:text-gray-700 prose-code:font-normal prose-code:break-words prose-inline-code:px-1.5 prose-inline-code:py-0.5 prose-code:whitespace-pre-wrap prose-code:text-xs prose-code:bg-gray-200 prose-code:rounded-md prose-pre:bg-gray-200 prose-pre:text-gray-700 prose-pre:overflow-x-auto max-w-none px-0 py-4 md:p-4 prose-code:before:hidden prose-code:after:hidden prose-mark:bg-gray-300 prose-td:border-gray-300 prose-td:border prose-td:px-4 prose-th:border prose-th:border-gray-300 prose-th:px-4 prose-th:py-2 [&amp;_blockquote_.callout-title]:flex [&amp;_blockquote_.callout-title]:gap-2"><p>N&#x27;ayant pas envie d&#x27;utiliser une solution propriétaire pour gérer les commentaires de mon blog et d&#x27;envoyer mes données personnelles et les vôtres (adresse IP, nom et e-mail) sur des serveurs aux USA. Je me suis configuré une petite installation de <a class="" target="_blank" href="https://posativ.org/isso/">Isso</a>.</p>
<p>J&#x27;utilise <a class="" target="_blank" href="http://dokku.viewdocs.io/dokku/"><strong>dokku</strong></a> pour simplifier la création et les potentiels mises à jour de mes applications docker. C&#x27;est pour moi le moyen le plus simple de gérer une infrastructure web sans la complexité des VHOSTS, déploiements, certificats SSL, volumes et links docker, port binding etc...</p>
<p>PS: Si vous ne souhaitez pas utilisé dokku, vous pouvez simplement utiliser cette commande docker :</p>
<div class="relative group"><button type="button" class="invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none">Copier</button><pre><code class="language-bash">docker run -d --name isso -p 80:80 sheogorath/isso-docker
</code></pre></div>
<h2>Installation</h2>
<p>Première chose à faire on pull une image docker trouvé sur <a class="" target="_blank" href="https://hub.docker.com">https://hub.docker.com</a> et créer une application <strong>dokku</strong>.</p>
<div class="relative group"><button type="button" class="invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none">Copier</button><pre><code class="language-bash">docker pull sheogorath/isso-docker
dokku apps:create isso
</code></pre></div>
<p>On configure le nom de domaine de l&#x27;application ainsi que l&#x27;URL du blog qui va héberger le système de commentaire :</p>
<div class="relative group"><button type="button" class="invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none">Copier</button><pre><code class="language-bash">dokku domains:set isso isso.mondomaine.fr 
dokku config:set isso ISSO_HOST=https://blog.mondomaine.fr
</code></pre></div>
<p>D&#x27;autres paramètres existent, comme <code>ISSO_REQUIRE_EMAIL</code> qui permet de forcer le commentateur d&#x27;entrer une valeur dans le champ email :</p>








































<table><thead><tr><th>Name</th><th>Default value</th><th>Description</th></tr></thead><tbody><tr><td><code>ISSO_HOST</code></td><td><code>http://example.com</code></td><td>It corresponds with [General] -&gt; host <a class="" target="_blank" href="https://posativ.org/isso/docs/configuration/server/#general">Details</a></td></tr><tr><td><code>ISSO_NAME</code></td><td><code>comments.example.com</code></td><td>It corresponds with [General] -&gt; name <a class="" target="_blank" href="https://posativ.org/isso/docs/configuration/server/#general">Details</a></td></tr><tr><td><code>ISSO_MAX_AGE</code></td><td><code>30m</code></td><td>It corresponds with [General] -&gt; max-age <a class="" target="_blank" href="https://posativ.org/isso/docs/configuration/server/#general">Details</a></td></tr><tr><td><code>ISSO_REPLY_TO_SELF</code></td><td><code>false</code></td><td>It corresponds with [Guard] -&gt; reply-to-self <a class="" target="_blank" href="https://posativ.org/isso/docs/configuration/server/#guard">Details</a></td></tr><tr><td><code>ISSO_REQUIRE_EMAIL</code></td><td><code>false</code></td><td>It corresponds with [Guard] -&gt; require-email <a class="" target="_blank" href="https://posativ.org/isso/docs/configuration/server/#guard">Details</a></td></tr><tr><td><code>ISSO_REQUIRE_AUTHOR</code></td><td><code>false</code></td><td>It corresponds with [Guard] -&gt; require-author <a class="" target="_blank" href="https://posativ.org/isso/docs/configuration/server/#guard">Details</a></td></tr></tbody></table>
<p>En temps normal, <strong>dokku</strong> relie directement le port 80 du reverse proxy au port 80 de notre container isso grâce à la directive EXPOSE du Dockerfile, ça ne marche pas sur mon environnement, en attendant la résolution de mon <a class="" target="_blank" href="https://github.com/dokku/dokku/issues/2970">issue</a> voici les commandes à exécuter :</p>
<div class="relative group"><button type="button" class="invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none">Copier</button><pre><code class="language-bash">dokku proxy:ports-add isso http:80:80
dokku proxy:ports-remove isso http:80:5000
</code></pre></div>
<p>Après le paramétrage on déploie l&#x27;application isso :</p>
<div class="relative group"><button type="button" class="invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none">Copier</button><pre><code class="language-bash">docker tag sheogorath/isso-docker dokku/isso
docker deploy isso
</code></pre></div>
<p>Le serveur est maintenant accessible sur <code>http://isso.mondomaine.fr</code>, une erreur 400 bad request apparait c&#x27;est normal, isso acceptent seulement les requêtes envoyées depuis le(s) domaine(s) autorisé(s) via la directive <code>ISSO_HOST</code>.</p>
<p>Maintenant que le service isso est en ligne, la configuration de la partie client se fait simplement en ajoutant la librairie JavaScript et une balise <code>&lt;section&gt;</code> sur notre blog :</p>
<div class="relative group"><button type="button" class="invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none">Copier</button><pre><code class="language-html">&lt;script data-isso=&quot;//isso.mondomaine.fr/&quot; src=&quot;//isso.mondomaine.fr/js/embed.min.js&quot;&gt;&lt;/script&gt;
&lt;section id=&quot;isso-thread&quot;&gt;&lt;/section&gt;
</code></pre></div>
<p>D&#x27;autres paramètres que <code>data-isso</code> existent aussi, pour pouvoir afficher les avatars, votes, changer la langue etc... :</p>
<div class="relative group"><button type="button" class="invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none">Copier</button><pre><code class="language-html">&lt;script data-isso=&quot;/prefix/&quot;
        data-isso-css=&quot;true&quot;
        data-isso-lang=&quot;ru&quot;
        data-isso-reply-to-self=&quot;false&quot;
        data-isso-require-author=&quot;false&quot;
        data-isso-require-email=&quot;false&quot;
        data-isso-max-comments-top=&quot;10&quot;
        data-isso-max-comments-nested=&quot;5&quot;
        data-isso-reveal-on-click=&quot;5&quot;
        data-isso-avatar=&quot;true&quot;
        data-isso-avatar-bg=&quot;#f0f0f0&quot;
        data-isso-avatar-fg=&quot;#9abf88 #5698c4 #e279a3 #9163b6 ...&quot;
        data-isso-vote=&quot;true&quot;
        data-vote-levels=&quot;&quot;
        src=&quot;/prefix/js/embed.js&quot;&gt;&lt;/script&gt;
</code></pre></div>
<p>Dans le cas de mon blog sous <strong>ghost</strong>, j&#x27;ai simplement édité mon thème Casper en ajoutant les lignes de code ci-dessus dans le fichier <code>post.hbs</code>.</p>
<h2>Bonus</h2>
<p>Pour éviter de perdre les commentaires en cas de mise a jour de <strong>isso</strong> on peut <strong>persister les données</strong> de cette façon :</p>
<div class="relative group"><button type="button" class="invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none">Copier</button><pre><code class="language-bash">dokku storage:mount isso /opt/isso:/data
</code></pre></div>
<p>Et si l&#x27;on souhaite ajouter un certificat let&#x27;s encrypt une simple commande dokku existe :</p>
<div class="relative group"><button type="button" class="invisible group-hover:visible absolute top-0 right-0 rounded-md text-xs bg-gray-300 m-3 p-1.5 cursor-pointer leading-none">Copier</button><pre><code class="language-bash">dokku letsencrypt isso
</code></pre></div>
<p>Voilà ! Si vous avez des questions, suggestions n&#x27;hésitez pas à les soumettre dans les commentaires ! Bon week-end ;)</p>
<hr/>
<p>Références :</p>
<ul>
<li>
<a title="Note bientôt disponible" class="!no-underline border-b-2 border-dotted border-cyan-700" href="/soon?title=H%C3%A9bergeur%20web">Hébergeur web</a>

</li>
</ul></article><div class="md:px-4"><hr class="border-gray-200 mb-4 mt-8"/><div id="commento"></div></div></div></main><footer class="container m-auto px-4 py-8 flex items-center justify-between flex-wrap lg:max-w-screen-lg text-gray-700"><div><span class="inline-block transform rotate-180">©</span><span class="ml-2">2017-2025</span></div><nav class="grid grid-flow-col gap-2 items-center"><a href="https://x.com/_johackim" aria-label="X" target="_blank" rel="noreferrer"><svg class="h-5 w-5 fill-current hover:text-black" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"></path></svg></a><a href="https://t.me/johackim" aria-label="Telegram" target="_blank" rel="noreferrer"><svg class="h-5 w-5 fill-current hover:text-black" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"></path></svg></a><a href="https://mastodon.ethibox.fr/@johackim" aria-label="Mastodon" target="_blank" rel="noreferrer"><svg class="h-5 w-5 fill-current hover:text-black" viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"></path></svg></a><a href="https://github.com/johackim" aria-label="Github" target="_blank" rel="noreferrer"><svg class="h-5 w-5 fill-current hover:text-black" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a href="https://linkedin.com/in/johackim" aria-label="LinkedIn" target="_blank" rel="noreferrer"><svg class="h-5 w-5 fill-current hover:text-black" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a href="mailto:contact+blog@johackim.com" aria-label="Mail" target="_blank" rel="noreferrer"><svg class="h-5 w-5 fill-current hover:text-black" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a><a href="/rss.xml" aria-label="RSS" target="_blank" rel="noreferrer"><svg class="h-5 w-5 fill-current hover:text-black" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg></a></nav></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    a: \"a\",\n    code: \"code\",\n    h2: \"h2\",\n    hr: \"hr\",\n    li: \"li\",\n    p: \"p\",\n    pre: \"pre\",\n    strong: \"strong\",\n    table: \"table\",\n    tbody: \"tbody\",\n    td: \"td\",\n    th: \"th\",\n    thead: \"thead\",\n    tr: \"tr\",\n    ul: \"ul\",\n    ..._provideComponents(),\n    ...props.components\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"N'ayant pas envie d'utiliser une solution propriétaire pour gérer les commentaires de mon blog et d'envoyer mes données personnelles et les vôtres (adresse IP, nom et e-mail) sur des serveurs aux USA. Je me suis configuré une petite installation de \", _jsx(_components.a, {\n        href: \"https://posativ.org/isso/\",\n        children: \"Isso\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"J'utilise \", _jsx(_components.a, {\n        href: \"http://dokku.viewdocs.io/dokku/\",\n        children: _jsx(_components.strong, {\n          children: \"dokku\"\n        })\n      }), \" pour simplifier la création et les potentiels mises à jour de mes applications docker. C'est pour moi le moyen le plus simple de gérer une infrastructure web sans la complexité des VHOSTS, déploiements, certificats SSL, volumes et links docker, port binding etc...\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"PS: Si vous ne souhaitez pas utilisé dokku, vous pouvez simplement utiliser cette commande docker :\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-bash\",\n        children: \"docker run -d --name isso -p 80:80 sheogorath/isso-docker\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Installation\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Première chose à faire on pull une image docker trouvé sur \", _jsx(_components.a, {\n        href: \"https://hub.docker.com\",\n        children: \"https://hub.docker.com\"\n      }), \" et créer une application \", _jsx(_components.strong, {\n        children: \"dokku\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-bash\",\n        children: \"docker pull sheogorath/isso-docker\\ndokku apps:create isso\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"On configure le nom de domaine de l'application ainsi que l'URL du blog qui va héberger le système de commentaire :\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-bash\",\n        children: \"dokku domains:set isso isso.mondomaine.fr \\ndokku config:set isso ISSO_HOST=https://blog.mondomaine.fr\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"D'autres paramètres existent, comme \", _jsx(_components.code, {\n        children: \"ISSO_REQUIRE_EMAIL\"\n      }), \" qui permet de forcer le commentateur d'entrer une valeur dans le champ email :\"]\n    }), \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Name\"\n          }), _jsx(_components.th, {\n            children: \"Default value\"\n          }), _jsx(_components.th, {\n            children: \"Description\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"ISSO_HOST\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"http://example.com\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"It corresponds with [General] -\u003e host \", _jsx(_components.a, {\n              href: \"https://posativ.org/isso/docs/configuration/server/#general\",\n              children: \"Details\"\n            })]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"ISSO_NAME\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"comments.example.com\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"It corresponds with [General] -\u003e name \", _jsx(_components.a, {\n              href: \"https://posativ.org/isso/docs/configuration/server/#general\",\n              children: \"Details\"\n            })]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"ISSO_MAX_AGE\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"30m\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"It corresponds with [General] -\u003e max-age \", _jsx(_components.a, {\n              href: \"https://posativ.org/isso/docs/configuration/server/#general\",\n              children: \"Details\"\n            })]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"ISSO_REPLY_TO_SELF\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"false\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"It corresponds with [Guard] -\u003e reply-to-self \", _jsx(_components.a, {\n              href: \"https://posativ.org/isso/docs/configuration/server/#guard\",\n              children: \"Details\"\n            })]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"ISSO_REQUIRE_EMAIL\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"false\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"It corresponds with [Guard] -\u003e require-email \", _jsx(_components.a, {\n              href: \"https://posativ.org/isso/docs/configuration/server/#guard\",\n              children: \"Details\"\n            })]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"ISSO_REQUIRE_AUTHOR\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"false\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"It corresponds with [Guard] -\u003e require-author \", _jsx(_components.a, {\n              href: \"https://posativ.org/isso/docs/configuration/server/#guard\",\n              children: \"Details\"\n            })]\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"En temps normal, \", _jsx(_components.strong, {\n        children: \"dokku\"\n      }), \" relie directement le port 80 du reverse proxy au port 80 de notre container isso grâce à la directive EXPOSE du Dockerfile, ça ne marche pas sur mon environnement, en attendant la résolution de mon \", _jsx(_components.a, {\n        href: \"https://github.com/dokku/dokku/issues/2970\",\n        children: \"issue\"\n      }), \" voici les commandes à exécuter :\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-bash\",\n        children: \"dokku proxy:ports-add isso http:80:80\\ndokku proxy:ports-remove isso http:80:5000\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Après le paramétrage on déploie l'application isso :\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-bash\",\n        children: \"docker tag sheogorath/isso-docker dokku/isso\\ndocker deploy isso\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Le serveur est maintenant accessible sur \", _jsx(_components.code, {\n        children: \"http://isso.mondomaine.fr\"\n      }), \", une erreur 400 bad request apparait c'est normal, isso acceptent seulement les requêtes envoyées depuis le(s) domaine(s) autorisé(s) via la directive \", _jsx(_components.code, {\n        children: \"ISSO_HOST\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Maintenant que le service isso est en ligne, la configuration de la partie client se fait simplement en ajoutant la librairie JavaScript et une balise \", _jsx(_components.code, {\n        children: \"\u003csection\u003e\"\n      }), \" sur notre blog :\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-html\",\n        children: \"\u003cscript data-isso=\\\"//isso.mondomaine.fr/\\\" src=\\\"//isso.mondomaine.fr/js/embed.min.js\\\"\u003e\u003c/script\u003e\\n\u003csection id=\\\"isso-thread\\\"\u003e\u003c/section\u003e\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"D'autres paramètres que \", _jsx(_components.code, {\n        children: \"data-isso\"\n      }), \" existent aussi, pour pouvoir afficher les avatars, votes, changer la langue etc... :\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-html\",\n        children: \"\u003cscript data-isso=\\\"/prefix/\\\"\\n        data-isso-css=\\\"true\\\"\\n        data-isso-lang=\\\"ru\\\"\\n        data-isso-reply-to-self=\\\"false\\\"\\n        data-isso-require-author=\\\"false\\\"\\n        data-isso-require-email=\\\"false\\\"\\n        data-isso-max-comments-top=\\\"10\\\"\\n        data-isso-max-comments-nested=\\\"5\\\"\\n        data-isso-reveal-on-click=\\\"5\\\"\\n        data-isso-avatar=\\\"true\\\"\\n        data-isso-avatar-bg=\\\"#f0f0f0\\\"\\n        data-isso-avatar-fg=\\\"#9abf88 #5698c4 #e279a3 #9163b6 ...\\\"\\n        data-isso-vote=\\\"true\\\"\\n        data-vote-levels=\\\"\\\"\\n        src=\\\"/prefix/js/embed.js\\\"\u003e\u003c/script\u003e\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Dans le cas de mon blog sous \", _jsx(_components.strong, {\n        children: \"ghost\"\n      }), \", j'ai simplement édité mon thème Casper en ajoutant les lignes de code ci-dessus dans le fichier \", _jsx(_components.code, {\n        children: \"post.hbs\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Bonus\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Pour éviter de perdre les commentaires en cas de mise a jour de \", _jsx(_components.strong, {\n        children: \"isso\"\n      }), \" on peut \", _jsx(_components.strong, {\n        children: \"persister les données\"\n      }), \" de cette façon :\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-bash\",\n        children: \"dokku storage:mount isso /opt/isso:/data\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Et si l'on souhaite ajouter un certificat let's encrypt une simple commande dokku existe :\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-bash\",\n        children: \"dokku letsencrypt isso\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Voilà ! Si vous avez des questions, suggestions n'hésitez pas à les soumettre dans les commentaires ! Bon week-end ;)\"\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.p, {\n      children: \"Références :\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.a, {\n          href: \"/hebergeur-web\",\n          title: \"Hébergeur web\",\n          className: \"not-found\",\n          children: \"Hébergeur web\"\n        }), \"\\n\\n\"]\n      }), \"\\n\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = {\n    ..._provideComponents(),\n    ...props.components\n  };\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{"title":"Installation d'une alternative open-source à Disqus","permalink":"installation-alternative-open-source-disqus","datePublished":"2017-11-03T18:00","dateUpdated":"2017-11-03T18:00","description":"N'ayant pas envie d'utiliser une solution propriétaire pour gérer les commentaires de mon blog je me suis configuré une petite installation de Isso via dokku.","publish":true,"rss":true,"aliases":["Disqus alternative"],"note":93},"scope":{}},"isIndex":false,"file":"Isso.md","fileName":"Isso","title":"Installation d'une alternative open-source à Disqus","comments":true,"permalink":"installation-alternative-open-source-disqus","datePublished":"2017-11-03T18:00","dateUpdated":"2017-11-03T18:00","description":"N'ayant pas envie d'utiliser une solution propriétaire pour gérer les commentaires de mon blog je me suis configuré une petite installation de Isso via dokku.","publish":true,"rss":true,"aliases":"","note":"93"},"__N_SSG":true},"page":"/[[...permalink]]","query":{"permalink":["installation-alternative-open-source-disqus"]},"buildId":"W4ieti9wfstDP6ydypVim","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>